# IoT 기반 통합 스마트홈 시스템

## 프로젝트 개요
현대 사회의 1인 가구 증가와 고령화에 따른 주거 환경의 스마트화 필요성에 대응하여, IoT 기술을 활용한 통합 스마트홈 시스템을 개발했습니다. Qt/C++, 아두이노, 라즈베리파이를 활용하여 실시간 모니터링, 보안/안전 관리, 반려동물 케어, 식물 관리 등 종합적인 스마트홈 기능을 제공합니다.

## 프로젝트 정보
- **개발 기간**: 2025.08.26(화) ~ 2025.09.16(화)
- **개발 장소**: 드론융합실
- **주요 주제**: 스마트홈

## 개발 환경
- **OS**: Ubuntu 24.04.2 LTS
- **언어**: C++
- **IDE**: Qt Creator, MySQL, VScode, Arduino
- **하드웨어**: 아두이노, 라즈베리파이, 각종 센서 모듈

## 팀원 및 담당 업무

### 통합 관제
| 이름 | 담당 업무 |
|------|----------|
| 조장 | 데이터 학습 및 팀원 트레이닝 |
| **이수민** | **메인 대시보드 UI 구현 및 실시간 센서 데이터 모니터링 시스템 개발** |
| 팀원1 | C++ 백엔드 서버, TCP 서버 및 데이터베이스 관리 시스템 개발 |
| 팀원2 | 블루투스 통신 |
| 팀원3 | 데이터베이스 관리 시스템 개발 |

### 안전/보안
| 이름 | 담당 업무 |
|------|----------|
| 팀원4 | 보안/화재 감지 시스템 구현 및 창문 장치 개발 |
| 팀원5 | 인증/등록 관리 시스템 구현 및 도어락, 창문 장치 개발 |

### 반려동물
| 이름 | 담당 업무 |
|------|----------|
| 팀원6 | 카메라와 초음파센서를 이용한 반려동물 인식 및 배변 감지 시스템 개발, 급수/급식기 디자인 |
| 팀원7 | 수중펌프 급수 시스템과 슬라이드판 배식 시스템, 급수/급식기 디자인 |
| 팀원8 | 데이터 자료 수집 |

### 식물
| 이름 | 담당 업무 |
|------|----------|
| 팀원9 | 아두이노 기반 토양 수분 센서와 자동 급수 펌프를 이용한 식물 관리 시스템 개발 |
| 팀원10 | 아두이노 기반 조도 센서 구현 |

## 개발 목적
현대 사회의 1인 가구 증가와 고령화에 따른 주거 환경의 스마트화 필요성에 대응하여, IoT 기술을 활용한 통합 스마트홈 시스템 개발

## 주요 구현 기능

### 1. 스마트홈 대시보드 ⭐ **이수민 담당 핵심 기능**
- **메인 대시보드 UI 표시**: 직관적이고 사용자 친화적인 인터페이스 구현
- **실시간 센서 데이터 모니터링**: 
  - 온도/습도 카드 표시
  - 화재/가스 상태 모니터링
  - 식물 습도 표시
  - 반려동물 상태(사료/물/배변) 표시
- **창문 제어 시스템**: 토글 스위치를 통한 원격 창문 제어
- **시계 및 날짜 표시**: 실시간 시간 정보 제공
- **페이지 네비게이션**: Safety/Certified/Search 화면 간 이동
- **TCP 클라이언트**: 서버와의 실시간 통신 구현

### 2. 보안/안전 관리
- **실시간 카메라 모니터링**: 카메라 ON/OFF 제어 및 라이브 영상 스트리밍
- **화재경보 시스템**: 화재경보 알림 발생 및 경보 중지 기능
- **119 신고 시스템**: 긴급상황 신고 및 통화 종료 기능

### 3. 얼굴 인증 시스템
- **얼굴 인식 및 등록**: OpenCV 기반 얼굴 검출 및 128x128 크롭
- **데이터베이스 연동**: MySQL 연결 및 얼굴 데이터 저장
- **카메라 제어**: 실시간 카메라 미리보기 및 자동 ON/OFF

### 4. 데이터 검색 시스템 ⭐ **이수민 관련 기능**
- **검색 조건 설정**: 카테고리별(온도/화재/가스/식물/펫) 및 날짜/시간 범위 검색
- **검색 결과 표시**: 테이블 형태 데이터 표시 및 시간순 정렬
- **실시간 데이터 업데이트**: 센서 데이터의 실시간 반영

### 5. 데이터베이스 관리
- **MySQL 연결 관리**: 싱글톤 패턴 구현 및 연결 상태 관리
- **센서 데이터 조회**: 최신 환경 데이터 및 각종 상태 조회
- **검색 기능**: 기간별 및 카테고리별 데이터 필터링

### 6. TCP 통신 시스템 ⭐ **이수민 담당 핵심 기능**
- **서버 연결 관리**: 자동 연결 및 재연결, 연결 상태 모니터링
- **창문 제어 명령 전송**: 창문 열기/닫기 명령 및 상태 조회
- **메시지 처리**: 실시간 서버 응답 수신 및 JSON/텍스트 메시지 파싱

### 7. 서버 시스템 (C++ 백엔드)
- **블루투스 통신 관리**: 다중 디바이스 연결 관리 및 제어 명령 송신
- **TCP 서버**: 멀티클라이언트 연결 관리 및 명령어 처리
- **데이터베이스 관리**: 센서 데이터 자동 저장 및 Thread-safe MySQL 연결

### 8. 반려동물 케어 시스템
- **배변시트 교체 알림**: 카메라와 초음파센서로 반려동물 인식 및 로봇팔 제어
- **자동 급수/배식**: 반려동물 인식 후 수중펌프 및 슬라이드판 제어

### 9. 식물 관리 시스템
- **센서 모니터링**: 토양 수분, 조도, 온도/습도 센서 통합 관리
- **자동 급수 제어**: 펌프 릴레이 제어 및 히스테리시스 시스템
- **시스템 안정성**: 스위칭 안정 시간 및 LCD 접근 제어

## 이수민 담당 기능 상세 분석

### 🎯 메인 대시보드 UI 구현
**핵심 역할**: 사용자가 모든 스마트홈 기능에 접근할 수 있는 중앙 허브 역할의 대시보드 개발

**구현 내용**:
- Qt Creator를 활용한 직관적인 사용자 인터페이스 설계
- 실시간 센서 데이터를 카드 형태로 시각화
- 각 기능별 상태 표시 및 제어 버튼 배치
- 반응형 레이아웃으로 다양한 화면 크기 지원

### 🔄 실시간 센서 데이터 모니터링 시스템
**핵심 역할**: 다양한 IoT 센서들로부터 받은 데이터를 실시간으로 처리하고 표시

**구현 내용**:
- **온도/습도 모니터링**: DHT11 센서 데이터 실시간 수집 및 표시
- **화재/가스 감지**: 위험 상황 실시간 모니터링 및 경고 표시
- **식물 상태 관리**: 토양 습도 데이터 실시간 업데이트
- **반려동물 케어**: 사료/물/배변 상태 실시간 모니터링
- 데이터 갱신 주기 최적화 및 네트워크 효율성 고려

### 🌐 TCP 클라이언트 통신 구현
**핵심 역할**: 클라이언트와 서버 간의 안정적인 실시간 통신 구현

**구현 내용**:
- QTcpSocket을 활용한 TCP 클라이언트 개발
- 자동 재연결 메커니즘 구현
- JSON 기반 메시지 프로토콜 설계 및 구현
- 창문 제어 명령 송수신 처리
- 연결 상태 실시간 모니터링 및 오류 처리

### 🏠 창문 제어 시스템
**핵심 역할**: 사용자 인터페이스를 통한 스마트 창문 원격 제어

**구현 내용**:
- 토글 스위치 UI 컴포넌트 개발
- 창문 열기/닫기 명령 전송 로직
- 창문 상태 실시간 조회 및 표시
- 창문 각도 설정 기능 구현

## 시스템 아키텍처

### 전체 시스템 구조
```
[스마트홈 대시보드 (Qt Client)]  ← 이수민 담당 핵심 부분
              |
        [TCP 통신 계층]  ← 이수민 담당
              |
    [C++ 백엔드 서버]
              |
        [MySQL 데이터베이스]
              |
    [블루투스/시리얼 통신]
              |
[아두이노/라즈베리파이 하드웨어]
     |        |        |
[식물관리]  [펫케어]  [보안시스템]
```

### 이수민 담당 기술 스택
- **Frontend**: Qt Framework (Qt Creator)
- **네트워킹**: QTcpSocket, QTimer
- **데이터 처리**: JSON 파싱, 실시간 데이터 바인딩
- **UI/UX**: 반응형 레이아웃, 실시간 데이터 시각화
- **통신 프로토콜**: TCP/IP, 커스텀 메시지 프로토콜

## 개발 과정에서 겪은 문제와 해결방안

### 1. 소통의 부재 (파트 분배 문제)
**문제**: 전체적이고 난잡했던 업무로 인한 역할 모호성

**해결방안**: 보안(얼굴인증, CCTV), 애완동물(펫 모니터링), 식물(토양 습도 관리), 서버/클라이언트(DB 관리, 통신)로 명확히 분배. 각 파트별 담당자 지정 및 주 2회 정기 회의와 실시간 소통 채널 구축

### 2. 클라이언트/서버 개별 개발로 인한 호환성 문제
**문제**: 각각 따로 개발하여 통합 시 호환성 문제 발생

**해결방안**: 모든 기능을 중앙 서버로 집중시키는 아키텍처로 변경. MySQL 데이터베이스 중심으로 모든 센서 데이터 저장, TCP 통신을 통한 표준화된 프로토콜 정의

### 3. 블루투스 연결 문제
**문제**: 블루투스 디바이스 연결 불안정

**해결방안**: 터미널에서 bluetoothctl로 디바이스 스캔 후 pair 및 trust 설정, rfcomm 명령어로 가상 시리얼 포트 생성 및 자동 재연결 스크립트 구현

### 4. 재료 수급 어려움
**해결방안**: 다른 팀 미사용 재료 양보, 기존 보유 재료 재활용, 개인 사비 구매 및 호환 가능한 대체 부품 창의적 조합

### 5. AI 학습 하드웨어 성능 부족
**해결방안**: 온라인 AI 학습툴(roboflow 등) 활용

### 6. 라즈베리파이 TCP 통신 및 성능 문제
**해결방안**: 라즈베리파이 내부에 1차 DB 생성 후 일정 시간 간격으로 데이터 평균치를 서버 DB로 송신하여 저장

## 이수민의 기여도 및 성과

### 🏆 주요 성과
1. **사용자 중심의 대시보드 UI 설계**: 직관적이고 효율적인 사용자 경험 제공
2. **실시간 데이터 모니터링 시스템**: 안정적이고 신속한 센서 데이터 처리
3. **견고한 TCP 통신 구현**: 자동 재연결 및 오류 처리로 시스템 안정성 확보
4. **통합 관제 시스템**: 모든 스마트홈 기능을 하나의 인터페이스로 통합 관리

### 🛠 기술적 기여
- **Qt Framework 활용**: 크로스 플랫폼 GUI 애플리케이션 개발 역량
- **네트워크 프로그래밍**: TCP/IP 소켓 통신 및 프로토콜 설계 경험
- **실시간 시스템**: 센서 데이터 실시간 처리 및 시각화 기술
- **시스템 통합**: 다양한 IoT 디바이스와의 통합 관제 시스템 구축

## 설치 및 실행

### 사전 요구사항
```bash
# Qt 개발 환경 설치
sudo apt-get install qt6-base-dev qt6-tools-dev

# MySQL 클라이언트 라이브러리
sudo apt-get install libmysqlclient-dev

# OpenCV (얼굴 인식용)
sudo apt-get install libopencv-dev
```

### 컴파일 및 실행
```bash
# 프로젝트 클론
git clone [repository-url]
cd smart-home-system

# Qt Creator에서 프로젝트 열기
# 또는 명령줄 컴파일
qmake SmartHome.pro
make

# 실행
./SmartHomeClient
```

### 데이터베이스 설정
```sql
-- 스마트홈 데이터베이스 생성
CREATE DATABASE smarthome_db;

-- 센서 데이터 테이블
CREATE TABLE sensor_data (
    id INT AUTO_INCREMENT PRIMARY KEY,
    category VARCHAR(20),
    temperature FLOAT,
    humidity FLOAT,
    timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- 얼굴 인증 테이블
CREATE TABLE face_images (
    id INT AUTO_INCREMENT PRIMARY KEY,
    user_id VARCHAR(50),
    user_name VARCHAR(100),
    image_data LONGBLOB,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

## 프로젝트 구조
```
smart-home-system/
├── client/                    # 클라이언트 애플리케이션 (이수민 담당)
│   ├── main.cpp
│   ├── mainwindow.cpp        # 메인 대시보드 UI
│   ├── tcpclient.cpp         # TCP 통신 클라이언트
│   ├── dashboard.cpp         # 대시보드 기능
│   └── datamonitor.cpp       # 실시간 데이터 모니터링
├── server/                   # 서버 시스템
│   ├── tcpserver.cpp
│   ├── bluetoothmanager.cpp
│   └── dbmanager.cpp
├── arduino/                  # 아두이노 코드
│   ├── plant_monitor/
│   └── pet_care/
├── database/                 # DB 스키마
└── resources/               # UI 리소스
```

## 향후 개선 방향
- **모바일 앱 지원**: 스마트폰을 통한 원격 제어
- **AI 기능 강화**: 더 정교한 패턴 인식 및 예측 시스템
- **에너지 관리**: 전력 사용량 모니터링 및 최적화
- **확장성 개선**: 더 많은 IoT 디바이스 지원
- **보안 강화**: 암호화 통신 및 접근 권한 관리

## 라이센스
이 프로젝트는 교육 목적으로 제작되었습니다.
